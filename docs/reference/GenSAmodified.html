<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extension of the GenSA function available in the CRAN package of the same name — GenSAmodified • rsofun</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extension of the GenSA function available in the CRAN package of the same name — GenSAmodified" />
<meta property="og:description" content="This function is an extension of the function GenSA defined in the package GenSA available on CRAN.
The only difference with the existing version is that GenSAmodified allows the user to pass
lower bounds and upper bounds with equal values. Though this is a trivial
scenario in which case the optimal solution should be lower = upper, the current version of GenSA crashes.
Copied from https://rdrr.io/github/cmottet/RobustTail/src/R/GenSAModified.R" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rsofun</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example_lm3ppa.html">Example</a>
    </li>
    <li>
      <a href="../articles/example_pmodel.html">Example for using rsofun</a>
    </li>
    <li>
      <a href="../articles/prepare_inputs_rsofun.html">Prepare rsofun forcing data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stineb/rsofun/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extension of the GenSA function available in the CRAN package of the same name</h1>
    <small class="dont-index">Source: <a href='https://github.com/stineb/rsofun/blob/master/R/GenSAModified.R'><code>R/GenSAModified.R</code></a></small>
    <div class="hidden name"><code>GenSAmodified.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is an extension of the function GenSA defined in the package GenSA available on CRAN.
The only difference with the existing version is that <em>GenSAmodified</em> allows the user to pass
lower bounds and upper bounds with equal values. Though this is a trivial
scenario in which case the optimal solution should be lower = upper, the current version of GenSA crashes.
Copied from https://rdrr.io/github/cmottet/RobustTail/src/R/GenSAModified.R</p>
    </div>

    <pre class="usage"><span class='fu'>GenSAmodified</span>(<span class='kw'>par</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>fn</span>, <span class='no'>lower</span>, <span class='no'>upper</span>, <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(), <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>par</th>
      <td><p>Vector. Initial values for the components to be optimized. Default is <code>NULL</code>, in which case, default values will be generated automatically.</p></td>
    </tr>
    <tr>
      <th>fn</th>
      <td><p>A function to be minimized, with first argument the vector of parameters over which minimization is to take place. It should return
            a scalar result.</p></td>
    </tr>
    <tr>
      <th>lower</th>
      <td><p>Vector with length of <code>par</code>. Lower bounds for components.</p></td>
    </tr>
    <tr>
      <th>upper</th>
      <td><p>Vector with length of <code>par</code>. Upper bounds for components.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>The argument is a list that can be used to control the behavior of the algorithm:</p><dl'>
                <dt><code>maxit</code></dt><dd><p>Integer. Maximum number of iterations of the algorithm.</p></dd>
                <dt><code>threshold.stop</code></dt><dd><p>Numeric. The program will stop when the expected objective function value <code>threshold.stop</code> is reached. Default value is <code>NULL</code></p></dd>
                <dt><code>nb.stop.improvement</code></dt><dd><p>Integer. The program will stop when there is no any improvement in <code>nb.stop.improvement</code> steps.</p></dd>
                <dt><code>smooth</code></dt><dd><p>Logical.<code>TRUE</code> when the objective function is smooth, or differentiable almost everywhere in the
                        region of <code>par</code>, <code>FALSE</code> otherwise. Default value is <code>TRUE</code>.</p></dd>
                <dt><code>max.call</code></dt><dd><p>Integer. Maximum number of call of the objective function. Default is set to 1e7.</p></dd>
                <dt><code>max.time</code></dt><dd><p>Numeric. Maximum running time in seconds.</p></dd>
                <dt><code>temperature</code></dt><dd><p>Numeric. Initial value for temperature.</p></dd>
                <dt><code>visiting.param</code></dt><dd><p>Numeric. Parameter for visiting distribution.</p></dd>
                <dt><code>acceptance.param</code></dt><dd><p>Numeric. Parameter for acceptance distribution.</p></dd>
                <dt><code>verbose</code></dt><dd><p>Logical. <code>TRUE</code> means that messages from the algorithm are shown. Default is <code>FALSE</code>.</p></dd>
                <dt><code>simple.function</code></dt><dd><p>Logical. <code>FALSE</code> means that the objective function has only a few local minima. Default is <code>FALSE</code> which means that the objective function is complicated with many local minima.</p></dd>
                <dt><code>trace.mat</code></dt><dd><p>Logical. Default is <code>TRUE</code> which means that the trace matrix will be available in the returned value of <code>GenSA</code> call.</p></dd>
                <dt><code>seed</code></dt><dd><p>Integer. Negative integer value that can be set to
                    initialize the internal random generator.</p></dd>
            
</dl><p></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>allows the user to pass additional arguments to the function <code>fn</code>.</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Test GenSAmodified in the univariate case</span>
<span class='no'>fn1</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='no'>x</span>
<span class='no'>bound</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>RobustTail</span><span class='kw ns'>:::</span><span class='fu'>GenSAmodified</span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn1</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fl'>1</span>,<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fl'>1</span>,<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; <span class='error'>Error in loadNamespace(name): there is no package called ‘RobustTail’</span></div><div class='input'><span class='no'>bound</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'bound' not found</span></div><div class='input'><span class='kw pkg'>GenSA</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/GenSA/man/GenSA.html'>GenSA</a></span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn1</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fl'>1</span>,<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fl'>1</span>,<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fl'>1</span>) <span class='co'># This crashes</span></div><div class='output co'>#&gt; <span class='error'>Error in GenSA::GenSA(fn = fn1, par = 1, lower = 1, upper = 1): Lower and upper bounds are not consistent (lower &gt;= upper)</span></div><div class='input'>
<span class='co'># Test GenSAmodified in the bivariate case with one lower bound equal to the upper bound</span>
<span class='no'>fn2</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='no'>x</span>[<span class='fl'>1</span>] + <span class='no'>x</span>[<span class='fl'>2</span>]
<span class='no'>bound</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>RobustTail</span><span class='kw ns'>:::</span><span class='fu'>GenSAmodified</span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn2</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>),<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>3</span>))</div><div class='output co'>#&gt; <span class='error'>Error in loadNamespace(name): there is no package called ‘RobustTail’</span></div><div class='input'><span class='no'>bound</span>$<span class='no'>par</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'bound' not found</span></div><div class='input'><span class='no'>bound</span>$<span class='no'>value</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'bound' not found</span></div><div class='input'>
<span class='kw pkg'>GenSA</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/GenSA/man/GenSA.html'>GenSA</a></span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn2</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>),<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>3</span>))<span class='co'># This crashes</span></div><div class='output co'>#&gt; <span class='error'>Error in GenSA::GenSA(fn = fn2, par = c(1, 2), lower = c(1, 1), upper = c(1,     3)): Lower and upper bounds are not consistent (lower &gt;= upper)</span></div><div class='input'>
<span class='co'># Test GenSAmodified in the bivariate case with both lower bound are equal to the upper bounds</span>
<span class='no'>bound</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>RobustTail</span><span class='kw ns'>:::</span><span class='fu'>GenSAmodified</span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn2</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>),<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>),<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>))</div><div class='output co'>#&gt; <span class='error'>Error in loadNamespace(name): there is no package called ‘RobustTail’</span></div><div class='input'><span class='no'>bound</span>$<span class='no'>par</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'bound' not found</span></div><div class='input'><span class='no'>bound</span>$<span class='no'>value</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'bound' not found</span></div><div class='input'>
<span class='kw pkg'>GenSA</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/GenSA/man/GenSA.html'>GenSA</a></span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn2</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>),<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>),<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>)) <span class='co'># This crashes</span></div><div class='output co'>#&gt; <span class='error'>Error in GenSA::GenSA(fn = fn2, par = c(1, 1), lower = c(1, 1), upper = c(1,     1)): Lower and upper bounds are not consistent (lower &gt;= upper)</span></div><div class='input'>
<span class='co'># Let's check that when the lower bounds are strictly smaller than the upper bounds,</span>
<span class='co'># all goes well</span>
<span class='no'>outGenSAmodified</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>RobustTail</span><span class='kw ns'>:::</span><span class='fu'>GenSAmodified</span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn2</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>3</span>))</div><div class='output co'>#&gt; <span class='error'>Error in loadNamespace(name): there is no package called ‘RobustTail’</span></div><div class='input'><span class='no'>outGenSA</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>GenSA</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/GenSA/man/GenSA.html'>GenSA</a></span>(<span class='kw'>fn</span> <span class='kw'>=</span> <span class='no'>fn2</span>,<span class='kw'>par</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>3</span>))

<span class='co'># Check that they have the same optimal solution</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span>(<span class='no'>outGenSAmodified</span>$<span class='no'>par</span> <span class='kw'>==</span> <span class='no'>outGenSA</span>$<span class='no'>par</span>)</div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'outGenSAmodified' not found</span></div><div class='input'>
<span class='co'># Check that they have the same optimal objective value</span>
<span class='no'>outGenSAmodified</span>$<span class='no'>value</span> <span class='kw'>==</span> <span class='no'>outGenSA</span>$<span class='no'>value</span></div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'outGenSAmodified' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Benjamin Stocker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


